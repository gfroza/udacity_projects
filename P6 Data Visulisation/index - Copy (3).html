<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="http://dimplejs.org/dist/dimple.v2.0.0.min.js"></script>
        <style>
            h1 {text-align: center;)
			
			div.categories_buttons {
			  position: fixed;
			  top: 30%;
			  left: 85%;
			  padding: 3px;
			  margin: 7px;
			}
        </style>

    </head>
    <body>
        <script type="text/javascript">
            function draw(data, xVariable) {

                /*
                 D3.js setup code
                 */

                "use strict";
                // Chart heading added to visualisation
                var title = d3.select("body").append("h1").text("Titanic: The Data Tells a Story");

                var margin = 75,
                    width = 1400 - margin,
                    height = 600 - margin;

                var svg = d3.select("body").append("svg").attr("width", width + margin).attr("height", height + margin).append('g').attr('class', 'chart');

                /*
                 Dimple.js Chart construction code
                 */
                // 1. Format the data:
                //  The '+' tells d3.js that the data is numeric
                //  add whatever variables you need to be numeric:
                data.forEach(function(d) {
                    d.Age = +d['Age'];
                    d.PassengerId = +d['PassengerId'];
					d.Survived = +d['Survived'];
					d.Pclass = d.Pclass
                });

                var myChart = new dimple.chart(svg, data);
                console.log(data);
                var x = myChart.addMeasureAxis("y", "Survived");
				x.title = "Number of Passengers";

                //  2. Use a category axis for text (and discrete) variables
                myChart.addCategoryAxis("x", xVariable);

                //  3. Add a key, to stop addSeries aggregating:
                var mySeries = myChart.addSeries(['Survived'], dimple.plot.bar);
                mySeries.aggregate = dimple.aggregateMethod.count;
				myChart.draw();
            };
			

	
	
	var finalChart
	var categories = [ "Sex", "Pclass" ];
    var categories_labels = {"Sex": "Sex", "Pclass": "Class" };
    var current_category = "Sex";
    var cat_buttons = d3.select("body")
            .append("div")
            .attr("class", "categories_buttons")
            .selectAll("div")
            .data(categories)
            .enter()
            .append("div")
            .attr("class", "indiv_btn")
            .text(function(d) {
                return d;
            });
    cat_buttons.on("click", function(d) {
        d3.select(".categories_buttons")
          .selectAll("div")
          .transition()
          .duration(500)
          .style("color", "black")
          .style("background", "rgb(251, 201, 127)");
        d3.select(this)
          .transition()
          .duration(500)
          .style("background", "lightBlue")
          .style("color", "white");
        finalChart.selectAll("*").remove();
        finalChart = draw(data, categories_labels[d]);
		current_category = d;
    });
			
	//Set up and read data from CSV file and draw chart
    data = d3.csv("titanic_data - Copy.csv", draw)
        </script>

    </body>
</html>
